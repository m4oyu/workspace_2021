# Chapter 12 シグナルによるプロセス間の通信

#### シグナルの用途
- プロセス間通信
- ソフトウェア割り込み

## 12.1 シグナルのライフサイクル
生成・送信 -> 受信・（無視 or 処理）

## 12.2 シグナルの種類
- ハンドルできないもの：kill, stopなどのプロセス終了処理
- サーバーアプリケーションでハンドルするもの：
- コンソールアプリケーションでハンドルするもの：Ctrl+CやCtrl+\など
- その他：ハードウェアに起因するものなど

## 12.3 Go言語におけるシグナルの種類
- ハンドル不可
    - 算術エラー、メモリ範囲外アクセス、ハードウェア例外など致命的なもの
    - sigkill, sigstopなど
- ハンドル可能
    - 終了ステータス１：sigquitなど
    - パニック、終了ステータス２など
    - 無視
    
## 12.4 シグナルのハンドラ
- signal.Notify()でシグナルを検知 -> ハンドリング
- シグナルの無視、ハンドラのリセット、停止、シグナルの送信など
- 親プロセスを停止する際には子プロセスへsigtermを送り、ゾンビプロセスの発生を防ぐ

## 12.5 シグナルの応用例（Server::Starter）
- 古いサーバから新しいサーバへの引継ぎをうまくする（グレイスフル・リスタート）
- Server::Starterからプロセスを起動し、切り替える。
    - この時起動するプロセスは、親プロセスからsigtermを受け取った際に新規リクエストの受付を停止するように設計
        - サーバ自体はgoroutineで起動し、外部から停止などをおこなう
- k8sでもサービスのアップデート時には末端にsigtermが送られる

## 12.6 Go言語ランタイムにおけるシグナルの内部実装
- マルチスレッドのプログラムではシグナル処理用のスレッドを別途設けることが必要。（Go言語でもそのように実装されている）

